schemaVersion: '2.0.0'

# Test cấu trúc container cho API Gateway Service
commandTests:
  - name: 'node version check'
    command: 'node'
    args: ['--version']
    expectedOutput: ['v18.*']
  
  - name: 'npm version check'
    command: 'npm'
    args: ['--version']
    expectedOutput: ['.*']

  - name: 'check if api-gateway service is executable'
    command: 'node'
    args: ['/app/index.js']
    exitCode: 0
    timeout: 10

fileExistenceTests:
  - name: 'app entry point exists'
    path: '/app/index.js'
    shouldExist: true

  - name: 'package.json exists'
    path: '/app/package.json'
    shouldExist: true

  - name: 'node_modules exists'
    path: '/app/node_modules'
    shouldExist: true

fileContentTests:
  - name: 'package.json has correct main entry'
    path: '/app/package.json'
    expectedContents: ['.*"main".*"index.js".*']

metadataTest:
  exposedPorts: ["3003"]
  env:
    - key: 'NODE_ENV'
      value: 'production'
  workdir: '/app'